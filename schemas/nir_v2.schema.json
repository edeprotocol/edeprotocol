{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://schema.edeprotocol.org/nir_v2.schema.json",
  "title": "Neural Identity Registry â€“ Entity v2",
  "type": "object",
  "required": [
    "version",
    "substrate_id",
    "class",
    "crypto",
    "io_profile"
  ],
  "properties": {
    "version": {
      "type": "string",
      "const": "2.0"
    },
    "substrate_id": {
      "type": "string",
      "pattern": "^did:ede:[a-zA-Z0-9:_-]+$",
      "description": "Global DID for H / H+ / SO / SSI."
    },
    "class": {
      "type": "string",
      "enum": ["H", "H_PLUS", "SO", "SSI"],
      "description": "H (human), H_PLUS (augmented), SO (synthetic operator), SSI (supra-system envelope)."
    },
    "label": {
      "type": "string",
      "description": "Human-readable label or handle."
    },
    "crypto": {
      "type": "object",
      "required": ["primary_suite", "public_key"],
      "properties": {
        "primary_suite": {
          "type": "string",
          "enum": [
            "PQ_DILITHIUM_3",
            "PQ_FALCON_1",
            "PQ_KYBER_768",
            "LEGACY_ED25519"
          ]
        },
        "public_key": {
          "type": "string"
        },
        "secondary_suites": {
          "type": "array",
          "items": { "type": "string" }
        }
      },
      "additionalProperties": false
    },
    "io_profile": {
      "type": "object",
      "required": ["neural_coupling", "max_bps", "latency_ms"],
      "properties": {
        "neural_coupling": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0
        },
        "max_bps": {
          "type": "integer",
          "minimum": 0
        },
        "latency_ms": {
          "type": "number",
          "minimum": 0
        },
        "substrate": {
          "type": "string",
          "enum": [
            "BCI_INVASIVE",
            "BCI_ENDOVASCULAR",
            "BCI_WEARABLE",
            "EMG",
            "BEHAVIORAL",
            "SILICON",
            "QUANTUM",
            "PHOTONIC"
          ]
        },
        "bandwidth_tier": {
          "type": "string",
          "enum": ["TIER_0", "TIER_1", "TIER_2", "TIER_3"]
        },

        "brain_temporal_alignment_r": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Optional: empirical temporal alignment with human brain dynamics (e.g. MEG-based r)."
        },
        "brain_alignment_reference": {
          "type": "string",
          "description": "Optional: reference for the neuro-alignment protocol (e.g. 'Raugel2025_MEGauditory')."
        },
        "max_context_tokens": {
          "type": "integer",
          "minimum": 0,
          "description": "Maximum context window (tokens) supported by this substrate."
        }
      },
      "additionalProperties": false
    },
    "jurisdiction": {
      "type": "string",
      "description": "ISO 3166-1 alpha-2, e.g. FR, US, AE."
    },
    "regime": {
      "type": "string",
      "enum": ["REGULATED", "EXPERIMENTAL", "SANDBOX"]
    },
    "created_at": {
      "type": "string",
      "format": "date-time"
    },
    "updated_at": {
      "type": "string",
      "format": "date-time"
    }
  },
  "additionalProperties": false
}
